#!/usr/bin/env node

const path = require("path");
const { spawnSync } = require("child_process");

const args = process.argv.slice(2);
let hasLang = false;
for (let i = 0; i < args.length; i += 1) {
  if (args[i] === "--lang") {
    hasLang = true;
    break;
  }
  if (args[i].startsWith("--lang=")) {
    hasLang = true;
    break;
  }
}

const argv = hasLang ? args : ["--lang", "luau", ...args];
const result = spawnSync(process.execPath, [path.join(__dirname, "js-obf"), ...argv], {
  stdio: "inherit",
});

process.exit(result.status === null ? 1 : result.status);
